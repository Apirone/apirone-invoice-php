document.addEventListener("DOMContentLoaded", function(){const d=document;const c=d.getElementById('invoice_id');const a=c?c.value:null;const e=d.getElementById('statusUrl');const f=e?e.attributes.href.value:null;let g=null;async function h(){const a=await fetch(`${f}?invoice=${a}`);const c=await a.text();return c}function i(){const a=d.querySelector('.btn.toggler');a&&a.addEventListener('click', function(){d.querySelector('.status-data').classList.toggle('historyFlag')})}async function j(){if(!f){return}const a=await fetch(`${f}?invoice=${a}&offset=${a}`, {method:'POST',headers:{'X-Requested-With':'XMLHttpRequest'}});const c=await a.text();const d=d.getElementById('__apn-invoice');d.outerHTML=c;g=d.getElementById('statusNum').value;k();i();l();stat=await h();async function e(){if(!g){clearInterval(processId);return}g=await h();g!==stat&&document.location.reload()};g>0&&(processId=setInterval(e, 1e4))}function k(){for(const e of d.querySelectorAll('.btn__copy'))e.addEventListener('click', function(){a(this)});function a(e){let i=e.firstChild;if(navigator.clipboard&&window.isSecureContext){navigator.clipboard.writeText(i.value)}else{i.type="text";i.focus();i.select();d.execCommand('copy');i.type="hidden"}e.classList.toggle('copied');setTimeout(function(){e.classList.toggle('copied')}, 1000, e)}}function l(){expire=d.getElementById('expire');if(expire===null||expire.value<=0){return}let a=d.getElementById('countdown');if(a===null){return}let c=expire.value;console.log(c);const d=setInterval(()=>{const a=Math.floor(c/(60*60*24));const c=Math.floor((c%(60*60*24))/(60*60));const d=Math.floor((c%(60*60))/60);const e=Math.floor((c%60));a.innerHTML=a>0?`${a}d `:''+c>0?`${c}h `:''+d>0?`${d}m `:''+`${e}s`;c-=1;c<0&&(clearInterval(d),a.innerHTML='')}, 1000)}j()});
